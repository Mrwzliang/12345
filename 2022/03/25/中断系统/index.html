<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.wzljava.xyz","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"livere","storage":true,"lazyload":false,"nav":null,"activeClass":"livere"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="中断技术起初是为了解决快速的CPU与慢速的外部设备之间传送数据的矛盾，现在应用更广泛，计算机故障检测与自动处理，实时信息处理，多道程序分时操作和人机交互等。">
<meta property="og:type" content="article">
<meta property="og:title" content="中断系统">
<meta property="og:url" content="http://www.wzljava.xyz/2022/03/25/%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="small love">
<meta property="og:description" content="中断技术起初是为了解决快速的CPU与慢速的外部设备之间传送数据的矛盾，现在应用更广泛，计算机故障检测与自动处理，实时信息处理，多道程序分时操作和人机交互等。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-03-25T13:58:02.000Z">
<meta property="article:modified_time" content="2022-04-29T13:33:28.806Z">
<meta property="article:author" content="shymakers">
<meta property="article:tag" content="微信计算机原理与接口技术">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://www.wzljava.xyz/2022/03/25/%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://www.wzljava.xyz/2022/03/25/%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F/","path":"2022/03/25/中断系统/","title":"中断系统"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>中断系统 | small love</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">small love</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="shymakers"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">shymakers</p>
  <div class="site-description" itemprop="description">得到的都是侥幸</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>
  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=33875750&auto=1&height=66"></iframe>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.wzljava.xyz/2022/03/25/%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="shymakers">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="small love">
      <meta itemprop="description" content="得到的都是侥幸">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="中断系统 | small love">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          中断系统
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-03-25 21:58:02" itemprop="dateCreated datePublished" datetime="2022-03-25T21:58:02+08:00">2022-03-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%AE%E4%BF%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86%E4%B8%8E%E6%8E%A5%E5%8F%A3%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">微信计算机原理与接口技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>中断技术起初是为了解决快速的CPU与慢速的外部设备之间传送数据的矛盾，现在应用更广泛，计算机故障检测与自动处理，实时信息处理，多道程序分时操作和人机交互等。</p>
<span id="more"></span>
<p><b>中断基本概念：</b><br>中断是指CPU在执行程序的过程中，由于某种外部或者内部事件的作用，使CPU停止当前正在执行的程序而转去为该事件服务，待事件服务结束后又能自动返回继续执行被中断的程序。<br>相对被中断的原程序来说，中断处理程序是临时嵌入的一段程序，所以一般将被中断的原程序称为主程序，而将中断处理的程序称为中断服务子程序，主程序被中止的<br>地方称为断点，<b>也就是下一条指令所在内存嗯地址。</b>中断服务子程序一般存放在内存中一个固定得到区域内，它的其实地址称为<b>中断服务子程序入口地址。</b></p>
<p><b>下面看一下中断源以及分类</b><br>中断源即能够引发中断的事件，即发出中断请求的来源。根据中断源的不同，将中断分为内部与外部中断。<br>外部中断即CPU以外的设备发出，由CPU中断请求信号引脚输入所引发，也称硬件中断。80x86CPU有2个引脚(INTR与NMI)可以接收外部中断请求信号，由输入到INTR引脚的中断请求<br>信号称为可屏蔽中断，输入到NMI引脚的中断请求称为非屏蔽中断。<br>内部中断即由CPU内部事件，即由CPU硬件故障或程序执行中的事件所引发的中断，内部中断还可以进一步分为软件中断与异常。<br>执行有定义的INT n指令而引发的中断即软件中断，软件中断可分为：BIOS DOS中断，DOS中断又可分为DOS专用中断，DOS保留中断，用户可调用的DOS中断以及保留<br>给用户开发的中断。由于CPU本身故障，程序故障引起的中断称为异常。例如当计算结果溢出，执行指令时发现特权级不正确等情况。<br>根据引起异常的程序是否可被恢复和恢复点不同，把异常进一步分类为故障 陷阱 中止（具体这就不说啦）。</p>
<p><b>下面看一下中断类型码，中断向量与中断向量表</b><br>为了区别这些不同的中断，微机系统给每一个中断分配了一个中断号 n，即中断类型码，其取值范围是0<del>255。微机系统可以处理256种中断，英特尔在它各种<br>微处理器中保留了0</del>31即32个为系统专用，其余的用户设定。<br>部分中断如下：<br>0型中断：除法错中断 1型中断：单步或陷阱中断  2型中断：非屏蔽硬件中断 。。。。<br>中断向量与中断向量表：在实模式下，<b>中断向量是指中断服务程序的入口地址。</b>每个中断号对应的中断向量占4个字节，前两个字节为中断服务程序入口的<br>偏移地址，后两个字节为中断服务程序所在代码段段基址。中断向量表即在实模式下，系统存储器地址空间中，最低1KB空间即00000H<del>003FFH单元依次存放着256个<br>中断向量，每个中断的中断向量为4个字节，存放这1024个字节中断向量的存储区就构成了一张中断向量表。<br>比如n型中断向量存放在中断向量表中4*n</del>4<em>n+3的4个单元之中，4</em>n+0: n型服务程序入口偏移地址低8位 4<em>n+1:….高8位<br>4</em>n+2: n型服务程序所在代码段段基地址低8位 4*n+3:…高8位。<br>中断向量表初始化：<br>由BIOS设计的中断服务程序（INT 16H ,INT 10H） ,其中断向量在加电时由BIOS负责写入中断向量表。<br>由DOS设计的中断服务程序（INT 21H），其中断向量是在启动DOS，由DOS负责写入中断向量表。<br>用户程序开发的中断服务程序，由用户程序写入其中断向量。</p>
<p>看个栗子：<br>设n型中断服务程序的名字是SERVICE，将SERVICE的入口地址写如对应的中断向量表得到方法如下：<br>方法一：用自己编写程序填写中断向量<br>CLI  （关中断）<br>PUSH DS （保护现场）<br>MOV AX, 0000H<br>MOV DS,AX  （基地址为0000H）<br>MOV BX,4<em>n  （偏移地址是4</em>n）<br>MOV AX,OFFSET SERVICE<br>MOV [BX],AX   (服务程序入口偏移地址写入4<em>n和4</em>n+1单元)<br>MOV AX,SEG SERVICE<br>MOV [BX+2],AX  (服务程序段基地写入4<em>n+2和4</em>n+3单元)<br>POP DS<br>STI         (开中断)<br>方法二：DOS设计2个子程序，专门用于中断向量的读出与写入。</p>
<p><b>中断响应和处理过程</b><br>微机系统中，各种类型中断的响应和处理过程不完全相同，<b>主要区别于中断类型码的获取方式不同</b>，当CPU获得了中断类型码后的处理过程基本类似。<br>对于非屏蔽硬件中断请求，CPU内部会自动产生中断类型码2；对于可屏蔽硬件中断请求，当CPU处于开中断状态，由外部中断控制器将相应的中断类型码送给CPU；<br>对于异常，中断类型码也是自动形成的；对于INT n指令，中断类型码即为指令中给定的n.<br>CPU获得中断类型码n后，中断处理过程如下：<br>F寄存器内容压入堆栈，保护各个标志位。<br>清楚I标志和T标志，屏蔽新的可屏蔽硬件中关和单步中断。<br>保护住程序的断点，即将主程序端点处CS，IP的当前值压入堆栈，压入的顺序为：先压入断点的CS值，再压入短点的IP值。<br>CPU从4<em>n~4</em>n+3单元去除n型中断向量写入IP,CS中，其中将4<em>n~4</em>n+1单元的内容写入IP，4<em>n+2~4</em>n+3单元的内容写入CS.<br>CPU根据新的CS:IP的值转向n型中断服务子程序。<br>服务程序执行完毕，执行中断返回指令。<br>CPU根据恢复后的CS:IP返回断点，继续执行主程序<br>从上述过程可知，当CPU获得中断类型码后，在中断向量的引导下，CPU执行相应的中断服务程序<br><b>中断服务子程序的结构</b><br>ISR       PROC<br>    保护现场</p>
<pre><code>中断处理

恢复现场

中断返回
</code></pre>
<p>ISR    ENDP<br>说明：<br>保护现场 ：中断服务子程序中使用到的寄存器或者内存单元如果主程序中也使用就会发生冲突，so进入中断服务程序的第一步就是要保护现场，将主程序用到的资源保存。<br>保护现场有两个方面，第一就是保存主程序的断点，其二就是保存通用寄存器和状态寄存器的内容前者由中断隐指令完成后者由中断服务程序完成。<br>中断处理：不同的中断请求所需要的中断服务是不同的，实际有效的工作是在这部分完成。<br>恢复现场：将各个寄存器的内容出栈<br>中断返回：中断返回指令时IRET，使服务子程序能安全返回之前由中断隐指令保存的主程序断点。</p>
<p><b>多级中断管理</b><br>中断优先与中断分级<br>多个中断源在同一时刻提出请求时，CPU对中断响应的次序称为中断优先级。中断响应的次序是用排队器硬件实现的。80x86响应中断的优先级由高到低：<br>除法错-&gt;软件中断INT n-&gt;断点中断-&gt;溢出中断INTO-&gt;NMI中断-&gt;INTR中断-&gt;单步中断。<br><b>中断系统应具备的基本功能</b><br>对于硬件中断，接口电路中应具备屏蔽与开放的功能，这种功能由程序员通过软件去控制。<br>能实现中断判优即中断源排队，当多个中断源提出请求时，能能够优先响应高级别的中断。<br>能够实现中断嵌套。<br>一旦响应中断，就能自动转入中断服务程序，处理完毕能能够自动返回断点。</p>
<p><b>80x86中断指令</b><br>1.开中断指令STI 功能：F寄存器中I标志置1，CPU处于开中断状态。<br>2.关中断指令CLI 功能：F寄存器中I标志清零，CPU处于关中断状态。<br>3.软件中断指令INT n:<br>n取值0<del>255之间有定义的无符号整数。 功能：无条件转向n型中断服务子程序。INT n指令的执行过程—-CPU响应软件中断的过程。<br>   1.F寄存器-&gt;栈（保存INT n之前的F状态）使F中的T标志置0—-禁止单步操作。I标志置0—-CPU处于关中断状态。<br>   2.断点地址–&gt;栈<br>   先：断点所在段基地址（CS）-&gt;栈。<br>   后：断点偏移地址（IP）-&gt;栈。<br>   3.CPU从4n</del>4n+3单元取出n型服务程序入口地址-&gt;IP:CS,从而转入n型中断服务程序</p>
<p><b></b><br><b></b><br><b></b></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>shymakers
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://www.wzljava.xyz/2022/03/25/%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F/" title="中断系统">http://www.wzljava.xyz/2022/03/25/中断系统/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E5%BE%AE%E4%BF%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86%E4%B8%8E%E6%8E%A5%E5%8F%A3%E6%8A%80%E6%9C%AF/" rel="tag"># 微信计算机原理与接口技术</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/03/23/%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/" rel="prev" title="输入输出系统">
                  <i class="fa fa-chevron-left"></i> 输入输出系统
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/04/22/field-automation/" rel="next" title="field_automation">
                  field_automation <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8zNDM0OC8xMDg4NQ=="></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wzl</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  




<script src="/js/third-party/comments/livere.js"></script>

</body>
</html>
